{% extends "base.html" %}

{% block title %}Book Store - BookHub{% endblock %}

{% block content %}
<div class="container">
    <div class="welcome-section">
        <h1>Welcome back, {{ user_name }}! ðŸ‘‹</h1>
        <p>Discover your next favorite book from our collection</p>
    </div>

    <div class="filters-section">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Search books by title or author...">
        </div>
        <div class="filter-options">
            <select id="categoryFilter">
                <option value="">All Categories</option>
                <option value="Fiction">Fiction</option>
                <option value="Non-Fiction">Non-Fiction</option>
                <option value="Mystery">Mystery</option>
                <option value="Science Fiction">Science Fiction</option>
                <option value="Fantasy">Fantasy</option>
                <option value="Biography">Biography</option>
                <option value="History">History</option>
                <option value="Self-Help">Self-Help</option>
            </select>
        </div>
    </div>

    <div class="books-grid" id="booksGrid">
        {% if products %}
            {% for book in products %}
            <div class="book-card" data-category="{{ book[3] }}" data-title="{{ book[1].lower() }}">
                <div class="book-image">
                    <img src="data:image/jpeg;base64,{{ book[2] }}" alt="{{ book[1] }}">
                    {% if book[5] and book[5] < book[4] %}
                    <div class="discount-badge">
                        SAVE {{ (( book[5] / book[4] * 100) | round | int) }}%
                    </div>
                    {% endif %}
                </div>
                
                <div class="book-info">
                    <h3 class="book-title">{{ book[1] }}</h3>
                    <p class="book-category">{{ book[3] }}</p>
                    
                    <div class="book-pricing">
                        {% if book[5] and book[5] < book[4] %}
                            <span class="discount-price">â‚¹{{ book[4] - book[5] }}</span>
                            <span class="original-price">â‚¹{{ book[4] }}</span>
                            <span class="savings">You save: â‚¹{{ book[5] }}</span>
                        {% else %}
                            <span class="current-price">â‚¹{{ book[4] }}</span>
                        {% endif %}
                    </div>
                    
                    <div class="book-stock">
                        {% if book[6] > 0 %}
                            <span class="in-stock">
                                <i class="fas fa-check-circle"></i>
                                {{ book[6] }} in stock
                            </span>
                        {% else %}
                            <span class="out-of-stock">
                                <i class="fas fa-times-circle"></i>
                                Out of stock
                            </span>
                        {% endif %}
                    </div>
                </div>
                
                <div class="book-actions">
                    {% if book[6] > 0 %}
                        <button class="btn btn-primary btn-full add-to-cart-btn" 
                                data-product-id="{{ book[0] }}"
                                data-stock="{{ book[6] }}">
                            <i class="fas fa-cart-plus"></i>
                            Add to Cart
                        </button>
                    {% else %}
                        <button class="btn btn-outline btn-full" disabled>
                            <i class="fas fa-bell"></i>
                            Notify Me
                        </button>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <i class="fas fa-book-open"></i>
                <h3>No Books Available</h3>
                <p>Check back later for new arrivals</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}